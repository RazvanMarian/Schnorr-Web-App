@using LicentaWebApp.Shared.Models
@inject IDialogService _dialogService

<MudBadge Content="@NotificationsNumber" Color="Color.Primary" Overlap="true">
    <MudMenu Icon="@Icons.Material.Outlined.Notifications" Color="Color.Default"
             MaxHeight="200" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter">

        @foreach (var notification in Notifications)
        {
            <MudMenuItem OnClick="@(_ => OpenNotification(@notification))">
                @notification.FileName @notification.CreatedAt.TimeOfDay
            </MudMenuItem>
        }
    </MudMenu>
</MudBadge>



@code{
    private bool _isOpen = false;

    [Parameter]
    public int NotificationsNumber { get; set; }

    [Parameter]
    public List<Notification> Notifications { get; set; } = new();

    private void ToggleOpen()
    {
        _isOpen = !_isOpen;
    }


    private void OpenNotification(Notification notification)
    {
        DialogOptions dialogOptions = new DialogOptions();
        dialogOptions.FullWidth = true;
        dialogOptions.CloseButton = true;
        dialogOptions.NoHeader = false;
        var parameters = new DialogParameters { ["Note"]=notification };
        _dialogService.Show<NotificationDialog>("Options Dialog",parameters,dialogOptions);
        StateHasChanged();
    }

}